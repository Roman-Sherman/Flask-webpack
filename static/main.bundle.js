(()=>{function e(e,t){const n=`${e}`;switch(t){case"detailed":return`An ultra-detailed, high-resolution image of ${n}. The image should be sharp, lifelike, with intricate textures, vivid colors, and a perfect representation of every aspect of the subject.`;case"animated":return`A vibrant, animated-style illustration of ${n}. This image should feature bold, exaggerated elements, playful colors, and a unique flair that captures the subject in a fun, dynamic, and stylized way.`;case"sketch":return`A finely detailed, pencil sketch of ${n}. This image should emphasize clean lines, intricate shading, and realistic proportions, creating a hand-drawn feel.`;case"abstract":return`An abstract interpretation of ${n}. Use bold colors, unconventional shapes, and fluid composition to convey the essence of the subject rather than its literal form.`;case"vintage":return`A vintage-style image of ${n}, with faded tones, sepia or black-and-white coloring, and a nostalgic, retro feel. The subject should evoke an old-time aesthetic with delicate textures.`;case"cyberpunk":return`A high-tech, futuristic cyberpunk-style image of ${n}. Focus on neon lights, dark urban environments, and a gritty, dystopian aesthetic with technological elements.`;case"minimalist":return`A minimalist representation of ${n}. Use simple lines, geometric shapes, and limited colors to create a clean and modern look. The image should focus on simplicity and elegance.`;case"watercolor":return`A delicate watercolor painting of ${n}. The image should have soft edges, fluid blending of colors, and a gentle, organic feel.`;case"low-poly":return`A low-poly, geometric representation of ${n}. The image should consist of sharp, angular shapes with vibrant color blocks, emphasizing form and structure over fine detail.`;default:return`A detailed image of ${n}.`}}localStorage.getItem("selectedStyle"),document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("menu-icon"),n=document.getElementById("dropdown-menu"),l=document.getElementById("videoFile");subtitleCardBtn=document.getElementById("subtitleCardtoggler");let o=!1;const a=document.getElementById("file-input"),d=document.getElementById("file-upload-icon"),i=document.getElementById("image-upload-icon"),s=(document.getElementById("switch"),document.getElementById("subtitlebox")),c=document.getElementById("user-input"),r=document.getElementById("musicbox"),m=document.getElementById("output"),y=document.querySelector(".search-icon"),u=document.getElementById("style-icon2"),g=document.getElementById("variations-select"),p=document.querySelector(".variations-dropdown"),h=document.getElementById("style-icon"),E=document.getElementById("style-dropdown"),b=document.getElementById("style-dropdown2"),v=document.getElementById("text-input"),f=document.getElementById("generate-images"),k=document.getElementById("generate-summary"),I=document.getElementById("generate-subtitle"),B=document.getElementById("generate-tts"),x=document.getElementById("generate-videos"),C=document.getElementById("generate-image-tts"),S=document.getElementById("generate-image-music"),w=document.getElementById("font-style-edit");let L={};const A=document.getElementById("image-remove-cross"),_=document.getElementById("subtitle-style-edit");L={fontFamily:document.getElementById("fontFamily").value,fontColor:document.getElementById("fontColor").value,outlineColor:document.getElementById("outlineColor").value,fontScale:document.getElementById("fontScale").value,thickness:document.getElementById("thickness").value,alignment:document.getElementById("alignment").value},SubtitleselectedStyles={subtitlefontColor:document.getElementById("subtitlefontColor").value,subtitleHighlightColor:document.getElementById("subtitleHighlightColor").value,subtitleOutlineColor:document.getElementById("subtitleOutlineColor").value,subtitlefontScale:document.getElementById("subtitlefontScale").value,strokethickness:document.getElementById("thickness").value,subtitlefontFamily:document.getElementById("subtitlefontFamily").value,subtitlealignment:document.getElementById("subtitlealignment").value},document.getElementById("applyButton").addEventListener("click",(e=>{for(let e of Object.keys(L))console.log(e),L[e]=document.getElementById(e).value;w.style.display="none"})),document.getElementById("subtitleapplyButton").addEventListener("click",(e=>{for(let e of Object.keys(SubtitleselectedStyles))console.log(e),SubtitleselectedStyles[e]=document.getElementById(e).value;_.style.display="none"})),s.addEventListener("click",(()=>{s.checked?subtitleCardBtn.style.display="block":subtitleCardBtn.style.display="none"})),subtitleCardBtn.addEventListener("click",(()=>{_.style.display="block"}));let T=localStorage.getItem("selectedModelType")||"image_gen",O=localStorage.getItem("selectedVariations")||"1",F=localStorage.getItem("selectedStyle")||"detailed";g.value=O,h.addEventListener("click",(()=>{E.style.display="block"===E.style.display?"none":"block"})),u.addEventListener("click",(()=>{b.style.display="block"===b.style.display?"none":"block"})),document.getElementById("style-change").addEventListener("click",(()=>{document.getElementById("font-style-edit").style.display="block"})),document.addEventListener("click",(e=>{h.contains(e.target)||E.contains(e.target)||(E.style.display="none")})),document.addEventListener("click",(e=>{u.contains(e.target)||b.contains(e.target)||(b.style.display="none")})),document.getElementById("cancelButton").addEventListener("click",(e=>{w.style.display="none"})),document.getElementById("subtitlecancelButton").addEventListener("click",(e=>{_.style.display="none"}));const P=e=>{document.querySelectorAll("#style-dropdown .dropdown-item").forEach((e=>{e.classList.remove("selected")})),e.classList.add("selected"),document.querySelectorAll("#style-dropdown2 .dropdown-item2").forEach((e=>{e.classList.remove("selected")})),e.classList.add("selected")},$=document.getElementById("textBox"),N=document.getElementById("addtext-bar"),U=document.getElementById("addtext-input");function j(){$.checked?N.style.display="flex":N.style.display="none"}$.addEventListener("change",j),j(),document.querySelectorAll("#style-dropdown .dropdown-item").forEach((e=>{e.getAttribute("data-style")===F&&P(e),e.addEventListener("click",(e=>{F=e.target.getAttribute("data-style"),E.style.display="none",localStorage.setItem("selectedStyle",F),P(e.target)}))})),document.querySelectorAll("#style-dropdown2 .dropdown-item2").forEach((e=>{e.getAttribute("data-style")===F&&P(e),e.addEventListener("click",(e=>{F=e.target.getAttribute("data-style"),b.style.display="none",localStorage.setItem("selectedStyle",F),P(e.target)}))}));const q=e=>{d.style.display="summarization"===e||"tts"===e||"image_tts"===e?"inline-block":"none"},J=e=>{"sub_gen"===e?(c.style.display="none",l.style.display="inline-block",subtitleCardBtn.style.display="block"):(c.style.display="inline-block",l.style.display="none",subtitleCardBtn.style.display="none")},M=e=>{h.style.display="image_gen"===e?"inline-block":"none"},R=e=>{"image_tts"===e?(document.getElementById("text-checkbox-div").style.display="block",document.getElementById("Music-checkbox-div").style.display="block",document.getElementById("tts-checkbox-div").style.display="block",document.getElementById("sub-checkbox-div").style.display="block"):"image_gen"===e||"sub_gen"===e?(document.getElementById("text-checkbox-div").style.display="block",document.getElementById("Music-checkbox-div").style.display="none",document.getElementById("tts-checkbox-div").style.display="none",document.getElementById("sub-checkbox-div").style.display="none"):(document.getElementById("text-checkbox-div").style.display="none",document.getElementById("Music-checkbox-div").style.display="none",document.getElementById("tts-checkbox-div").style.display="none",document.getElementById("sub-checkbox-div").style.display="none")},H=(e,t)=>{p.style.display="image_gen"===e?"block":"none",q(e),M(e),(e=>{document.getElementById("speech-bar").style.display="image_tts"===e||"image_music"===e?"flex":"none"})(e),J(e),R(e),T=e,localStorage.setItem("selectedModelType",e),[f,k,B,x,C,S,I].forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),n.style.display="none"},z=e=>{[f,k,B,x,C,S,I].forEach((e=>{e.style.backgroundColor="",e.style.color=""})),e.style.backgroundColor="#f1f3f4",e.style.color="#202124"};"image_gen"===T?(H(T,f),z(f)):"summarization"===T?(H(T,k),z(k)):"tts"===T?(H(T,B),z(B)):"video_gen"===T?(H(T,x),z(x)):"image_tts"===T?(H(T,C),z(C)):"sub_gen"===T?(H(T,I),z(I)):"image_music"===T&&(H(T,S),z(S)),g.addEventListener("change",(e=>{O=e.target.value,localStorage.setItem("selectedVariations",O)})),t.addEventListener("click",(()=>{n.style.display="block"===n.style.display?"none":"block"})),d.addEventListener("click",(()=>{a.click()}));const D=document.getElementById("image-input");i.addEventListener("click",(()=>{D.click()})),A.addEventListener("click",(()=>{D.value="",v.value="",v.disabled=!1,A.style.display="none"})),D.addEventListener("change",(async()=>{const e=D.files[0];if(e&&e.type.startsWith("image/"))try{const t=await(e=>new Promise(((t,n)=>{const l=new FileReader;l.onload=()=>t(l.result),l.onerror=e=>n(e),l.readAsDataURL(e)})))(e);v.value=e.name,v.disabled=!0,A.style.display="block",window.currentImageData={name:e.name,type:e.type,base64Data:t},console.log("Image file loaded:",e.name)}catch(e){console.error("Error processing image:",e)}else console.log("Please upload a valid image file.")})),a.addEventListener("change",(()=>{const e=a.files[0];if(e){const t=new FileReader;t.onload=function(e){const t=e.target.result;c.value=t,console.log("File content added to input:",t)},"application/pdf"===e.type?t.readAsArrayBuffer(e):t.readAsText(e)}})),f.addEventListener("click",(()=>{H("image_gen",f),z(f)})),k.addEventListener("click",(()=>{H("summarization",k),z(k)})),B.addEventListener("click",(()=>{H("tts",B),z(B)})),x.addEventListener("click",(()=>{H("video_gen",x),z(x)})),C.addEventListener("click",(()=>{H("image_tts",C),z(C)})),I.addEventListener("click",(()=>{H("sub_gen",I),z(I)})),S.addEventListener("click",(()=>{H("image_music",S),z(S)})),c.addEventListener("keypress",(e=>{"Enter"===e.key&&(o=!0,y.click())})),y.addEventListener("mousedown",(()=>{o=!0})),y.addEventListener("click",(()=>{if(!1!==o){o=!1;try{tryRedirect()}catch(e){console.error("Error redirecting to Ad:",e);const t=document.getElementById("error-log");t.textContent=e.message,t.style.display="block"}(async()=>{const t=c.value,n=parseInt(g.value,10),o=document.getElementById("loader"),a=document.getElementById("error-log");if(!t&&"sub_gen"!=T)return a.textContent="Please enter some text!",void(a.style.display="block");let d;if(a.textContent="",a.style.display="none",o.style.display="inline-block","image_gen"===T?d={userText:e(t,F),count:n,addtext:U.value,textStyle:JSON.stringify(L),model_type:T}:"image_tts"===T||"image_music"===T?d={userText:e(v.value,F),speechText:t,textStyle:JSON.stringify(L),addtext:U.value,subtileStyle:JSON.stringify(SubtitleselectedStyles),addMusic:r.checked,subtitle:s.checked,selectedModelType:T,image:window.currentImageData||null}:"sub_gen"===T||(d={userText:t,subtileStyle:SubtitleselectedStyles,count:1,model_type:T}),"image_tts"==T||"image_music"==T)fetch("/api/genimg_tts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then((e=>e.ok?e.blob():(a.textContent="Failed to fetch data from the API. Please try again."+e.message,a.style.display="block",void(o.style.display="none")))).then((e=>{const t=URL.createObjectURL(e),n=document.createElement("video");n.src=t,n.controls=!0,n.style.width="100%",n.style.padding="20px",n.style.height="auto",document.getElementById("videoContainer").appendChild(n),o.style.display="none"})).catch((e=>{console.error("Error:",e),a.textContent="An error occurred while processing the video.",a.style.display="block",o.style.display="none"}));else if("sub_gen"===T){const e=new FormData;let t=U.value;e.append("video",l.files[0]),e.append("text",t),e.append("subtitleStyle",JSON.stringify(SubtitleselectedStyles)),fetch("/api/sub_gen",{method:"POST",body:e}).then((e=>e.ok?e.blob():(a.textContent="Failed to fetch data from the API. Please try again.",a.style.display="block",void(o.style.display="none")))).then((e=>{const t=URL.createObjectURL(e),n=document.createElement("video");n.src=t,n.controls=!0,n.style.width="100%",n.style.padding="20px",n.style.height="auto";const l=document.getElementById("videoContainer");l.innerHTML="",l.appendChild(n),o.style.display="none"})).catch((e=>{console.error("Error:",e),a.textContent="An error occurred while processing the video.",a.style.display="block",o.style.display="none"}))}else fetch("/api/huggingface_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then((e=>e.ok?e.json():(a.textContent="Failed to fetch data from the API. Please try again."+e.message,a.style.display="block",void(o.style.display="none")))).then((e=>{if(!e||0===e.length)return a.textContent="No data returned from the API.",a.style.display="block",void(o.style.display="none");o.style.display="none";const t=document.createElement("div");t.classList.add("output-images"),"image_gen"===T?e.forEach((e=>{if(e.type.startsWith("image")){const n=document.createElement("img");n.src=e.base64,n.alt="Generated Image",t.appendChild(n)}})):"image_tts"===T||"image_music"===T?e.forEach((e=>{const n=URL.createObjectURL(blob),l=document.createElement("video");l.src=n,l.controls=!0,l.autoplay=!1,t.appendChild(l)})):e.forEach((e=>{"text"===e.type?t.innerHTML+=`<p>${e.content.summary_text}</p>`:e.type.startsWith("audio")&&(t.innerHTML+=`<audio controls src="${e.base64}"></audio>`)})),m.appendChild(t),a.textContent="",a.style.display="none"})).catch((e=>{a.textContent="An unexpected error occurred while fetching data. Please try again. "+e.message,a.style.display="block",o.style.display="none"}))})()}else console.warn("Click event was triggered programmatically and ignored.")})),document.addEventListener("click",(e=>{n.contains(e.target)||e.target===t||(n.style.display="none")})),q(T),M(T),J(T),R(T)}))})(),(()=>{function e(e){const t=document.getElementById("error-log");try{let t=JSON.parse(localStorage.getItem("generationArchive"))||[];t.push(e),localStorage.setItem("generationArchive",JSON.stringify(t))}catch(e){t.textContent="Error: Failed to save data to local storage.",t.style.display="block"}}function t(){const e=document.getElementById("error-log");try{return JSON.parse(localStorage.getItem("generationArchive"))||[]}catch(t){return e.textContent="Error: Failed to load data from local storage.",e.style.display="block",[]}}function n(){const e=document.getElementById("archiveContainer"),l=document.getElementById("error-log");try{const o=t();e.innerHTML="",o.forEach(((o,a)=>{const d=document.getElementById("archiveEntryTemplate").content.cloneNode(!0).querySelector(".archive-entry"),i=d.querySelector(".media-container");if("audio"===o.mediaType){const e=document.createElement("audio");e.controls=!0,e.src=o.mediaUrl,i.appendChild(e)}else if("image"===o.mediaType){const e=document.createElement("img");e.style.maxWidth="100%",e.src=o.mediaUrl,i.appendChild(e);const t=d.querySelector(".formatSelect"),n=d.querySelector(".resolutionSelect");d.querySelector(".download-btn").onclick=async()=>{try{const l=t.value;let r=n.value;r="original"===r?{width:e.naturalWidth,height:e.naturalHeight}:JSON.parse(r);const m=await(d=o.mediaUrl,i=l,s=r.width,c=r.height,new Promise(((e,t)=>{const n=document.getElementById("error-log");try{const n=new Image;n.src=d,n.onload=()=>{const t=document.createElement("canvas"),l=t.getContext("2d");t.width=s,t.height=c,l.drawImage(n,0,0,s,c);const o=t.toDataURL(`image/${i}`);e(o)},n.onerror=()=>t("Error: Failed to load image for resizing.")}catch(e){n.textContent="Error: Failed to resize and convert image.",n.style.display="block",t(e)}}))),y=document.createElement("a");y.href=m,y.download=`image_${a+1}.${l}`,y.click()}catch(e){l.textContent="Error: Failed to download the image.",l.style.display="block"}var d,i,s,c}}else if("text"===o.mediaType){const e=document.createElement("div");e.textContent=o.textContent,i.appendChild(e)}d.querySelector(".removeBtn").onclick=()=>{!function(e){const n=document.getElementById("error-log");try{let n=t();n.splice(e,1),localStorage.setItem("generationArchive",JSON.stringify(n))}catch(e){n.textContent="Error: Failed to remove data from local storage.",n.style.display="block"}}(a),n()},e.appendChild(d)}))}catch(e){l.textContent="Error: Failed to display archive.",l.style.display="block"}}document.getElementById("generateTTSBtn").addEventListener("click",(async()=>{const t=document.getElementById("error-log");t.style.display="none",t.innerHTML="";let l=document.getElementById("ttsInput").value;const o=document.getElementById("audioCount").value,a=document.getElementById("model_type").value;if(!l)return t.textContent="Please enter some text!",void(t.style.display="block");if(!o||isNaN(o)||o<=0)return t.textContent="Please enter a valid number for audio count.",void(t.style.display="block");if(!a)return t.textContent="Please select a model type.",void(t.style.display="block");try{const d=async(e,t)=>"image_gen"==t?await enhancePromptImageGen(e):"summarization"==t?await enhancePromptSummarization(e):e;l=await d(l,a);const i=await fetch("/api/huggingface_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({count:o,userText:l,model_type:a})});if(!i.ok)return t.textContent="Failed to fetch data from Hugging Face API.",void(t.style.display="block");console.log(i);const s=await i.json();console.log(s);const c=document.getElementById("audioContainer"),r=async(t,n,l)=>{const o=document.createElement("audio");o.controls=!0,o.src=t.base64,e({mediaType:"audio",mediaUrl:t.base64,date:(new Date).toLocaleString()}),l.appendChild(o)},m=async(t,n,l)=>{const o=document.createElement("img");o.style.maxWidth="100%",o.src=t.base64,e({mediaType:"image",mediaUrl:t.base64,date:(new Date).toLocaleString()}),l.appendChild(o)},y=(t,n,l)=>{let o=`Summary ${n+1}: `+(t.content||JSON.stringify(t.content));e({mediaType:"text",textContent:o,date:(new Date).toLocaleString()});const a=document.createElement("div");a.textContent=o,l.appendChild(a)},u=(e,t,n)=>{const l=document.createElement("div");l.textContent=`Result ${t+1}: `+String(e),n.appendChild(l)};console.log(result),s.forEach((async(e,t)=>{e.type.startsWith("audio")?(console.log("asd"),r(e,t,c)):e.type.startsWith("image")?(console.log("asd2"),m(e,t,c)):e.type.startsWith("text")?(console.log("asd3"),y(e,t,c)):(console.log("asd4"),u(e,t,c)),c.appendChild(document.createTextNode(`Variation ${t+1}`)),c.appendChild(document.createElement("br"))})),n(),function(){const e=document.getElementById("archiveContainer"),t=document.getElementById("toggleArchiveBtn");e.style.display="block",t.textContent="Hide Archive"}()}catch(e){t.textContent="An unexpected error occurred.",t.style.display="block"}})),document.getElementById("toggleArchiveBtn").addEventListener("click",(()=>{const e=document.getElementById("archiveContainer"),t=document.getElementById("toggleArchiveBtn");"none"===e.style.display?(e.style.display="block",t.textContent="Hide Archive"):(e.style.display="none",t.textContent="Show Archive")})),window.onload=function(){n()}})();